CREATE OR REPLACE VIEW V_FUNCIONARIOS_ALL
(UNIDADE, FUNC_ID, FUNC_NOME, FUNC_RG, FUNC_REGISTRO, 
 FUNC_CARGO, FUNC_ATIVO, FUNC_ADMISSAO, FUNC_CC_NOME, FUNC_CPF, 
 FUNC_NASC, FUNC_JORNADA, ICARD, FUNC_DPTO, FUNC_ENDERECO, 
 FUNC_CIDADE, FUNC_BAIRRO, FUNC_CEP, FUNC_OGMO, FUNC_ESCOLARIDADE, 
 FUNC_CELULAR, FUNC_TELEFONE, FUNC_CNH, FUNC_TICKET_VALE, FUNC_DESC, 
 SENHA, DEPARTAMENTO, EMAIL, TIPO, RAMAL, 
 LOCAL, RADIO, FUNC_AMOSTRA1, FUNC_AMOSTRA2, FUNC_CC, 
 FUNC_EMAIL_GRUPO, ALIAS_EMAIL, ALTERA_REGISTRO, APELIDO, FUNC_DESLIGAMENTO, 
 FUNC_LOGIN, FUNC_SENTINEL, FUNC_REGIAO, CIDA_ID, FUNC_POSICAO, 
 FUNC_PPR, FUNC_DT_SENHA, FUNC_CONFERENCIA, FUNC_NOME_CRACHA, FUNC_RG_DATA_EXP, 
 FUNC_RG_ORG_EXP, FUNC_CNH_DATA_VENC, FUNC_PIS, FUNC_EMPRESA, FUNC_COD_CARGO, 
 FUNC_FILIAL, FUNC_MATRIZ, FUNC_NOME_PAI, FUNC_NOME_MAE, FUNC_CC_RESP, 
 FUNC_ESPEC, FUNC_BANCO, FUNC_RG_BDCC, USUA_RH_DESLIGA, FUNC_AFASTADO, 
 FUNC_GESTOR, FUNC_GESTOR_NOME, FUNC_AREA, FUNC_TP_MDO)
AS 
SELECT 'TECON' UNIDADE,
          MVF.FUNC_ID,
          MVF.FUNC_NOME,
          MVF.FUNC_RG,
          TO_CHAR (MVF.FUNC_REGISTRO) FUNC_REGISTRO,
          MVF.FUNC_CARGO,
          MVF.FUNC_ATIVO,
          MVF.FUNC_ADMISSAO,
          MVF.FUNC_CC_NOME,
          MVF.FUNC_CPF,
          MVF.FUNC_NASC,
          MVF.FUNC_JORNADA,
          MVF.ICARD,
          MVF.FUNC_DPTO,
          MVF.FUNC_ENDERECO,
          MVF.FUNC_CIDADE,
          MVF.FUNC_BAIRRO,
          MVF.FUNC_CEP,
          MVF.FUNC_OGMO,
          MVF.FUNC_ESCOLARIDADE,
          MVF.FUNC_CELULAR,
          MVF.FUNC_TELEFONE,
          MVF.FUNC_CNH,
          MVF.FUNC_TICKET_VALE,
          MVF.FUNC_DESC,
          MVF.SENHA,
          MVF.DEPARTAMENTO,
          MVF.EMAIL,
          MVF.TIPO,
          MVF.RAMAL,
          MVF.LOCAL,
          MVF.RADIO,
          MVF.FUNC_AMOSTRA1,
          MVF.FUNC_AMOSTRA2,
          MVF.FUNC_CC,
          MVF.FUNC_EMAIL_GRUPO,
          MVF.ALIAS_EMAIL,
          MVF.ALTERA_REGISTRO,
          MVF.APELIDO,
          MVF.FUNC_DESLIGAMENTO,
          MVF.FUNC_LOGIN,
          MVF.FUNC_SENTINEL,
          MVF.FUNC_REGIAO,
          MVF.CIDA_ID,
          MVF.FUNC_POSICAO,
          MVF.FUNC_PPR,
          MVF.FUNC_DT_SENHA,
          MVF.FUNC_CONFERENCIA,
          MVF.FUNC_NOME_CRACHA,
          MVF.FUNC_RG_DATA_EXP,
          MVF.FUNC_RG_ORG_EXP,
          MVF.FUNC_CNH_DATA_VENC,
          MVF.FUNC_PIS,
          MVF.FUNC_EMPRESA,
          MVF.FUNC_COD_CARGO,
          MVF.FUNC_FILIAL,
          MVF.FUNC_MATRIZ,
          MVF.FUNC_NOME_PAI,
          MVF.FUNC_NOME_MAE,
          MVF.FUNC_CC_RESP,
          MVF.FUNC_ESPEC,
          MVF.FUNC_BANCO,
          MVF.FUNC_RG_BDCC,
          MVF.USUA_RH_DESLIGA,
          MVF.FUNC_AFASTADO,
          MVF.FUNC_GESTOR,
          MVF.FUNC_GESTOR_NOME,
          MVF.FUNC_AREA,
          MVF.FUNC_TP_MDO
     FROM TELEMAT.FUNCIONARIOS MVF
    WHERE MVF.FUNC_FILIAL != 2                                         /*TEV*/
   UNION ALL
   SELECT 'TEV' UNIDADE,
          MVF.FUNC_ID,
          MVF.FUNC_NOME,
          MVF.FUNC_RG,
          TO_CHAR (MVF.FUNC_REGISTRO) FUNC_REGISTRO,
          MVF.FUNC_CARGO,
          MVF.FUNC_ATIVO,
          MVF.FUNC_ADMISSAO,
          MVF.FUNC_CC_NOME,
          MVF.FUNC_CPF,
          MVF.FUNC_NASC,
          MVF.FUNC_JORNADA,
          MVF.ICARD,
          MVF.FUNC_DPTO,
          MVF.FUNC_ENDERECO,
          MVF.FUNC_CIDADE,
          MVF.FUNC_BAIRRO,
          MVF.FUNC_CEP,
          MVF.FUNC_OGMO,
          MVF.FUNC_ESCOLARIDADE,
          MVF.FUNC_CELULAR,
          MVF.FUNC_TELEFONE,
          MVF.FUNC_CNH,
          MVF.FUNC_TICKET_VALE,
          MVF.FUNC_DESC,
          MVF.SENHA,
          MVF.DEPARTAMENTO,
          MVF.EMAIL,
          MVF.TIPO,
          MVF.RAMAL,
          MVF.LOCAL,
          MVF.RADIO,
          MVF.FUNC_AMOSTRA1,
          MVF.FUNC_AMOSTRA2,
          MVF.FUNC_CC,
          MVF.FUNC_EMAIL_GRUPO,
          MVF.ALIAS_EMAIL,
          MVF.ALTERA_REGISTRO,
          MVF.APELIDO,
          MVF.FUNC_DESLIGAMENTO,
          MVF.FUNC_LOGIN,
          MVF.FUNC_SENTINEL,
          MVF.FUNC_REGIAO,
          MVF.CIDA_ID,
          MVF.FUNC_POSICAO,
          MVF.FUNC_PPR,
          MVF.FUNC_DT_SENHA,
          MVF.FUNC_CONFERENCIA,
          MVF.FUNC_NOME_CRACHA,
          MVF.FUNC_RG_DATA_EXP,
          MVF.FUNC_RG_ORG_EXP,
          MVF.FUNC_CNH_DATA_VENC,
          MVF.FUNC_PIS,
          MVF.FUNC_EMPRESA,
          MVF.FUNC_COD_CARGO,
          MVF.FUNC_FILIAL,
          MVF.FUNC_MATRIZ,
          MVF.FUNC_NOME_PAI,
          MVF.FUNC_NOME_MAE,
          MVF.FUNC_CC_RESP,
          MVF.FUNC_ESPEC,
          MVF.FUNC_BANCO,
          MVF.FUNC_RG_BDCC,
          MVF.USUA_RH_DESLIGA,
          MVF.FUNC_AFASTADO,
          MVF.FUNC_GESTOR,
          MVF.FUNC_GESTOR_NOME,
          MVF.FUNC_AREA,
          MVF.FUNC_TP_MDO
     FROM TELEMAT.FUNCIONARIOS@CTIS_PROD MVF
    WHERE MVF.FUNC_FILIAL = 2                                          /*TEV*/
   UNION ALL
   SELECT 'LOGISTICA' UNIDADE,
          MVF.FUNC_ID,
          MVF.FUNC_NOME,
          MVF.FUNC_RG,
          TO_CHAR (MVF.FUNC_REGISTRO) FUNC_REGISTRO,
          MVF.FUNC_CARGO,
          MVF.FUNC_ATIVO,
          MVF.FUNC_ADMISSAO,
          MVF.FUNC_CC_NOME,
          MVF.FUNC_CPF,
          MVF.FUNC_NASC,
          MVF.FUNC_JORNADA,
          MVF.ICARD,
          MVF.FUNC_DPTO,
          MVF.FUNC_ENDERECO,
          MVF.FUNC_CIDADE,
          MVF.FUNC_BAIRRO,
          MVF.FUNC_CEP,
          MVF.FUNC_OGMO,
          MVF.FUNC_ESCOLARIDADE,
          MVF.FUNC_CELULAR,
          MVF.FUNC_TELEFONE,
          MVF.FUNC_CNH,
          MVF.FUNC_TICKET_VALE,
          MVF.FUNC_DESC,
          MVF.SENHA,
          MVF.DEPARTAMENTO,
          MVF.EMAIL,
          MVF.TIPO,
          MVF.RAMAL,
          MVF.LOCAL,
          MVF.RADIO,
          MVF.FUNC_AMOSTRA1,
          MVF.FUNC_AMOSTRA2,
          MVF.FUNC_CC,
          MVF.FUNC_EMAIL_GRUPO,
          MVF.ALIAS_EMAIL,
          MVF.ALTERA_REGISTRO,
          MVF.APELIDO,
          MVF.FUNC_DESLIGAMENTO,
          MVF.FUNC_LOGIN,
          MVF.FUNC_SENTINEL,
          MVF.FUNC_REGIAO,
          MVF.CIDA_ID,
          MVF.FUNC_POSICAO,
          MVF.FUNC_PPR,
          MVF.FUNC_DT_SENHA,
          MVF.FUNC_CONFERENCIA,
          MVF.FUNC_NOME_CRACHA,
          MVF.FUNC_RG_DATA_EXP,
          MVF.FUNC_RG_ORG_EXP,
          MVF.FUNC_CNH_DATA_VENC,
          MVF.FUNC_PIS,
          MVF.FUNC_EMPRESA,
          MVF.FUNC_COD_CARGO,
          MVF.FUNC_FILIAL,
          MVF.FUNC_MATRIZ,
          MVF.FUNC_NOME_PAI,
          MVF.FUNC_NOME_MAE,
          MVF.FUNC_CC_RESP,
          MVF.FUNC_ESPEC,
          MVF.FUNC_BANCO,
          MVF.FUNC_RG_BDCC,
          MVF.USUA_RH_DESLIGA,
          MVF.FUNC_AFASTADO,
          MVF.FUNC_GESTOR,
          MVF.FUNC_GESTOR_NOME,
          MVF.FUNC_AREA,
          MVF.FUNC_TP_MDO
     FROM TELEMAT.MV_FUNCIONARIOS_LOG MVF
   UNION ALL
   SELECT 'IMBITUBA' UNIDADE,
          MVF.FUNC_ID,
          MVF.FUNC_NOME,
          MVF.FUNC_RG,
          TO_CHAR (MVF.FUNC_REGISTRO) FUNC_REGISTRO,
          MVF.FUNC_CARGO,
          MVF.FUNC_ATIVO,
          MVF.FUNC_ADMISSAO,
          MVF.FUNC_CC_NOME,
          MVF.FUNC_CPF,
          MVF.FUNC_NASC,
          MVF.FUNC_JORNADA,
          MVF.ICARD,
          MVF.FUNC_DPTO,
          MVF.FUNC_ENDERECO,
          MVF.FUNC_CIDADE,
          MVF.FUNC_BAIRRO,
          MVF.FUNC_CEP,
          MVF.FUNC_OGMO,
          MVF.FUNC_ESCOLARIDADE,
          MVF.FUNC_CELULAR,
          MVF.FUNC_TELEFONE,
          MVF.FUNC_CNH,
          MVF.FUNC_TICKET_VALE,
          MVF.FUNC_DESC,
          MVF.SENHA,
          MVF.DEPARTAMENTO,
          MVF.EMAIL,
          MVF.TIPO,
          MVF.RAMAL,
          MVF.LOCAL,
          MVF.RADIO,
          MVF.FUNC_AMOSTRA1,
          MVF.FUNC_AMOSTRA2,
          MVF.FUNC_CC,
          MVF.FUNC_EMAIL_GRUPO,
          MVF.ALIAS_EMAIL,
          MVF.ALTERA_REGISTRO,
          MVF.APELIDO,
          MVF.FUNC_DESLIGAMENTO,
          MVF.FUNC_LOGIN,
          MVF.FUNC_SENTINEL,
          MVF.FUNC_REGIAO,
          MVF.CIDA_ID,
          MVF.FUNC_POSICAO,
          MVF.FUNC_PPR,
          MVF.FUNC_DT_SENHA,
          MVF.FUNC_CONFERENCIA,
          MVF.FUNC_NOME_CRACHA,
          MVF.FUNC_RG_DATA_EXP,
          MVF.FUNC_RG_ORG_EXP,
          MVF.FUNC_CNH_DATA_VENC,
          MVF.FUNC_PIS,
          MVF.FUNC_EMPRESA,
          MVF.FUNC_COD_CARGO,
          MVF.FUNC_FILIAL,
          MVF.FUNC_MATRIZ,
          MVF.FUNC_NOME_PAI,
          MVF.FUNC_NOME_MAE,
          MVF.FUNC_CC_RESP,
          MVF.FUNC_ESPEC,
          MVF.FUNC_BANCO,
          MVF.FUNC_RG_BDCC,
          MVF.USUA_RH_DESLIGA,
          MVF.FUNC_AFASTADO,
          MVF.FUNC_GESTOR,
          MVF.FUNC_GESTOR_NOME,
          MVF.FUNC_AREA,
          MVF.FUNC_TP_MDO
     FROM TELEMAT.MV_FUNCIONARIOS_IMB MVF
   UNION ALL
   SELECT 'CONVICON' UNIDADE,
          MVF.FUNC_ID,
          MVF.FUNC_NOME,
          MVF.FUNC_RG,
          TO_CHAR (MVF.FUNC_REGISTRO) FUNC_REGISTRO,
          MVF.FUNC_CARGO,
          MVF.FUNC_ATIVO,
          MVF.FUNC_ADMISSAO,
          MVF.FUNC_CC_NOME,
          MVF.FUNC_CPF,
          MVF.FUNC_NASC,
          MVF.FUNC_JORNADA,
          MVF.ICARD,
          MVF.FUNC_DPTO,
          MVF.FUNC_ENDERECO,
          MVF.FUNC_CIDADE,
          MVF.FUNC_BAIRRO,
          MVF.FUNC_CEP,
          MVF.FUNC_OGMO,
          MVF.FUNC_ESCOLARIDADE,
          MVF.FUNC_CELULAR,
          MVF.FUNC_TELEFONE,
          MVF.FUNC_CNH,
          MVF.FUNC_TICKET_VALE,
          MVF.FUNC_DESC,
          MVF.SENHA,
          MVF.DEPARTAMENTO,
          MVF.EMAIL,
          MVF.TIPO,
          MVF.RAMAL,
          MVF.LOCAL,
          MVF.RADIO,
          MVF.FUNC_AMOSTRA1,
          MVF.FUNC_AMOSTRA2,
          MVF.FUNC_CC,
          MVF.FUNC_EMAIL_GRUPO,
          MVF.ALIAS_EMAIL,
          MVF.ALTERA_REGISTRO,
          MVF.APELIDO,
          MVF.FUNC_DESLIGAMENTO,
          MVF.FUNC_LOGIN,
          MVF.FUNC_SENTINEL,
          MVF.FUNC_REGIAO,
          MVF.CIDA_ID,
          MVF.FUNC_POSICAO,
          MVF.FUNC_PPR,
          MVF.FUNC_DT_SENHA,
          MVF.FUNC_CONFERENCIA,
          MVF.FUNC_NOME_CRACHA,
          MVF.FUNC_RG_DATA_EXP,
          MVF.FUNC_RG_ORG_EXP,
          MVF.FUNC_CNH_DATA_VENC,
          MVF.FUNC_PIS,
          MVF.FUNC_EMPRESA,
          MVF.FUNC_COD_CARGO,
          MVF.FUNC_FILIAL,
          MVF.FUNC_MATRIZ,
          MVF.FUNC_NOME_PAI,
          MVF.FUNC_NOME_MAE,
          MVF.FUNC_CC_RESP,
          MVF.FUNC_ESPEC,
          MVF.FUNC_BANCO,
          MVF.FUNC_RG_BDCC,
          MVF.USUA_RH_DESLIGA,
          MVF.FUNC_AFASTADO,
          MVF.FUNC_GESTOR,
          MVF.FUNC_GESTOR_NOME,
          MVF.FUNC_AREA,
          MVF.FUNC_TP_MDO
     FROM TELEMAT.MV_FUNCIONARIOS_VDC MVF
/
--COMMIT